<!DOCTYPE html><!--MZ1yZpr1EuWGDHUHxIOaM--><html lang="en" class="h-full antialiased"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/pr-preview/pr-267/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/pr-preview/pr-267/_next/static/media/avatar.73d60a9f.png"/><link rel="preload" href="/avatar.png" as="image"/><link rel="stylesheet" href="/pr-preview/pr-267/_next/static/chunks/4c8fce464b786e05.css" data-precedence="next"/><link rel="stylesheet" href="/pr-preview/pr-267/_next/static/chunks/11a6a7cd862de9e1.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/pr-preview/pr-267/_next/static/chunks/a091ea4925d39c66.js"/><script src="/pr-preview/pr-267/_next/static/chunks/4f1ecdd32be4adb6.js" async=""></script><script src="/pr-preview/pr-267/_next/static/chunks/6e25ab32535aa058.js" async=""></script><script src="/pr-preview/pr-267/_next/static/chunks/7aa1a0202490b110.js" async=""></script><script src="/pr-preview/pr-267/_next/static/chunks/turbopack-98dea72be4f9dc83.js" async=""></script><script src="/pr-preview/pr-267/_next/static/chunks/c3bc6f5ffee68632.js" async=""></script><script src="/pr-preview/pr-267/_next/static/chunks/c050a2e2c81bfab4.js" async=""></script><script src="/pr-preview/pr-267/_next/static/chunks/7c4f85df3640cb60.js" async=""></script><script src="/pr-preview/pr-267/_next/static/chunks/67b669c080ef588c.js" async=""></script><link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png?v=2"/><link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png?v=2"/><link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png?v=2"/><link rel="manifest" href="/icons/site.webmanifest?v=2"/><link rel="mask-icon" href="/icons/safari-pinned-tab.svg?v=2" color="#00ff00"/><link rel="shortcut icon" href="/icons/favicon.ico?v=2"/><meta name="msapplication-TileColor" content="#535353"/><meta name="msapplication-config" content="/icons/browserconfig.xml?v=2"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="next-size-adjust" content=""/><title>I have a dream(rant) about secrets in repositories - InDieTasten</title><meta name="description" content="Homepage and blog by InDieTasten."/><meta property="og:title" content="I have a dream(rant) about secrets in repositories - InDieTasten"/><meta property="og:description" content="Homepage and blog by InDieTasten."/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="I have a dream(rant) about secrets in repositories - InDieTasten"/><meta name="twitter:description" content="Homepage and blog by InDieTasten."/><script src="/pr-preview/pr-267/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body class="flex h-full bg-zinc-900 md:bg-black"><div hidden=""><!--$--><!--/$--></div><div class="flex w-full"><div class="hidden md:fixed md:inset-0 md:flex md:justify-center md:px-8 pointer-events-none z-0" aria-hidden="true"><div class="flex w-full max-w-7xl lg:px-8"><div class="w-full ring-1 bg-zinc-900 ring-zinc-300/20"></div></div></div><div class="relative flex w-full flex-col text-zinc-400 z-10"><header class="pointer-events-none relative z-50 flex flex-none flex-col" style="height:var(--header-height);margin-bottom:var(--header-mb)"><div class="top-0 z-10 h-16 pt-6" style="position:var(--header-position)"><div class="sm:px-8 top-(--header-top,--spacing(6)) w-full" style="position:var(--header-inner-position)"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="relative flex gap-4"><div class="flex flex-1"><div class="h-10 w-10 rounded-full p-0.5 ring-1 shadow-lg shadow-zinc-800/5 backdrop-blur-sm bg-zinc-800/90 ring-white/10"><a aria-label="Home" class="pointer-events-auto" href="/pr-preview/pr-267"><img alt="" width="1710" height="1710" decoding="async" data-nimg="1" class="rounded-full object-cover bg-zinc-800 h-9 w-9" style="color:transparent" src="/pr-preview/pr-267/_next/static/media/avatar.73d60a9f.png"/></a></div></div><div class="flex flex-1 justify-end md:justify-center"><div class="pointer-events-auto md:hidden" data-headlessui-state=""><button class="group flex items-center rounded-full px-4 py-2 text-sm font-medium ring-1 shadow-lg shadow-zinc-800/5 backdrop-blur-sm bg-zinc-800/90 text-zinc-200 ring-white/10 hover:ring-white/20" type="button" aria-expanded="false" data-headlessui-state="">Menu<svg viewBox="0 0 8 6" aria-hidden="true" class="ml-3 h-auto w-2 stroke-zinc-500 group-hover:stroke-zinc-400"><path d="M1.75 1.75 4 4.25l2.25-2.5" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div><span hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></span><nav class="pointer-events-auto hidden md:block"><ul class="flex rounded-full px-3 text-sm font-medium ring-1 shadow-lg shadow-zinc-800/5 backdrop-blur-sm bg-zinc-800/90 text-zinc-200 ring-white/10"><li><a class="relative block px-3 py-2 transition hover:text-teal-400" href="/pr-preview/pr-267">About</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-400" href="/pr-preview/pr-267/articles">Articles</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-400" href="/pr-preview/pr-267/projects">Projects</a></li></ul></nav></div><div class="flex justify-end md:flex-1"><div class="pointer-events-auto"></div></div></div></div></div></div></div></div></header><main class="flex-auto"><main><div class="sm:px-8"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><article class="mb-32"><h1 class="text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">I have a dream(rant) about secrets in repositories</h1><div class="mb-4 flex flex-wrap gap-2"><span class="bg-gray-300 text-gray-700 px-2 py-1 rounded text-xs font-medium">#<!-- -->git</span><span class="bg-gray-300 text-gray-700 px-2 py-1 rounded text-xs font-medium">#<!-- -->secrets</span><span class="bg-gray-300 text-gray-700 px-2 py-1 rounded text-xs font-medium">#<!-- -->deployment</span></div><div class="hidden md:block md:mb-12"><div class="flex items-center"><img src="/avatar.png" class="w-12 h-12 rounded-full mr-4" alt="InDieTasten"/><div class="text-xl font-bold">InDieTasten</div></div></div><div class="max-w-2xl mx-auto"><div class="block md:hidden mb-6"><div class="flex items-center"><img src="/avatar.png" class="w-12 h-12 rounded-full mr-4" alt="InDieTasten"/><div class="text-xl font-bold">InDieTasten</div></div></div><div class="mb-6 text-lg"><time dateTime="2020-08-18T00:00:00.000Z">August	18, 2020</time></div></div><div class="max-w-2xl mx-auto"><div><p>TL DR: Please don't put them there</p>
<h2>What?</h2>
<p>I've been working in the software development business professionally for 5 years now.
The company I work for has yet to "discover" open source. We heavily use OSS, but have nothing up of our own stuff.
That may be the reason why nobody so far has ever questioned putting secrets into git repositories.</p>
<p>That would be one of the first lessons, when pushing anything into a public repository.
No secrets. It's that simple.</p>
<h2>Why not?</h2>
<p>For public repositories, I think it should be fairly obvious, that putting secrets there is a bad idea.</p>
<p>But even for private repos, there is always a chance of leaking the repo. A quick clone on some machine.
Drive may not be encrypted and the device gets lost. Of course you forget, which repos have been cloned to that machine.
Nobody keeps track of that. I have probably 30 something repos on my dev machine. Some of which containing secrets that can potentially cause damage.</p>
<pre><code>appsettings.json => connection strings => sql db => drop
</code></pre>
<p>Or even worse, silently taking dumps and blackmailing us. The problem wouldn't be as bad, when secrets would rotate often.
But sadly, that's another problem we haven't touched. It's been getting better lately, but there's still room for improvement.</p>
<p>Another problem is versioning. It might not come off as a huge problem, but the commit history is cluttered with our devops people
commiting "config" over and over again, as they want to trigger our continuous deployment with different settings in a trial and error manner.
It's a cool setup. We have branches for each environment, and you just have to merge into them, and as they update, they will be deployed.
It's cool as long as you go "forward". If you want to get back to a different version, or want to try a feature branch on some environment,
you will be faced with reverting commits, which is kinf of stupid, because then you'd have to revert the revert, if you were to ever test that
branch again. Resetting the branch would be better, but often people will branch off of these CD branches, so their branch will be infected with these broken config changes that way.</p>
<p>Also, any intern starting to set foot in one of the real projects requiring access to code,
will automatically be granted access to all of the environments secrets. Good stuff.</p>
<h2>A vision for improvement</h2>
<p>So what's my dream solution about?</p>
<p>Don't put secrets into the repository. Treat every repository, as if it was public.</p>
<p>What about that cool CI/CD pipeline we have going on?
Well, we can keep it. We just have to make some changes to it.</p>
<p>Have two build pipelines: Debug &#x26; Release</p>
<p>They are analogous to the build definitions Debug and Release.</p>
<p>Define your secrets in your Release pipelines.
Have a release pipeline for every environment.</p>
<p>Now you can use any build, and deploy it to any environment. No more config changes are tracked in the repo.
Having a hard to repro bug in production? Just deploy the Debug version there for some extra verbose error tracking for a couple minutes.</p>
<p>Want to test a feature branch? Select your preferred build definition. Select an environment, done.</p>
<p>As a bonus, you also have increased confidence,
that moving a code version from one environment to another won't introduce additional changes,
that may have happened in the target environment branch before.</p>
<p>Of course you still need to communicate about who is putting what into which environment.
Unless you can dynamically provision new environments,
but that's a dream for another night.</p>
<h3>But what if the config schema changes?</h3>
<p>That would break the pipelines, and that's good?</p>
<p>It's a great way to interpret semver for code, that nobody depends on.
If you develop a product with no exposed APIs,
it's a bit difficult to define what change would be breaking and therefor a major version increase.
But the configuration schema is kind of like an interface, that the application needs to support.</p>
<p>Whenever the config schema changes, or existing configs in your pipelines will break,
that's a major code version increase for your repository.</p>
<p>Now your repository is managing code only. Your commits can now focus on development.
No more "config". You don't have builds that only work for one environment.
You don't need to rebuild to move a code version from one environment to another.
You just deploy the same code with different config to the next environment.</p>
<pre><code>Code => Build

Build + Config => Release
</code></pre>
<p>And the intern can finally work on all them cool projects without seeing prod credentials.</p>
<p>A great time to be alive.</p>
<h2>Who is responsible for this mess?</h2>
<p>Microsoft.</p>
<p>All the samples and project templates are generating configuration files ready for committing them.
The default VS .gitignore won't ignore appsettings.json and similar files.</p>
<h1>Discussion</h1>
<p>Are you already living the dream?
Are there problems I haven't thought about?
Shoot me an issue on <a href="https://github.com/InDieTasten/indietasten.github.io/issues">GitHub</a>.</p></div></div></article></div></div></div></div></main><!--$--><!--/$--></main><footer class="mt-32 flex-none"><div class="sm:px-8"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="border-t pt-10 pb-16 border-zinc-700/40"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex flex-col items-center justify-between gap-6 md:flex-row"><div class="flex flex-wrap justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-200"><a class="transition hover:text-teal-400" href="/pr-preview/pr-267">About</a><a class="transition hover:text-teal-400" href="/pr-preview/pr-267/projects">Projects</a><a class="transition hover:text-teal-400" href="/pr-preview/pr-267/legal">Legal</a></div><p class="text-sm text-zinc-500">© 2011 InDieTasten. All rights reserved.</p></div></div></div></div></div></div></footer></div></div><script src="/pr-preview/pr-267/_next/static/chunks/a091ea4925d39c66.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[2971,[\"/pr-preview/pr-267/_next/static/chunks/c3bc6f5ffee68632.js\",\"/pr-preview/pr-267/_next/static/chunks/c050a2e2c81bfab4.js\"],\"Header\"]\n3:I[51608,[\"/pr-preview/pr-267/_next/static/chunks/7c4f85df3640cb60.js\",\"/pr-preview/pr-267/_next/static/chunks/67b669c080ef588c.js\"],\"default\"]\n4:I[21110,[\"/pr-preview/pr-267/_next/static/chunks/7c4f85df3640cb60.js\",\"/pr-preview/pr-267/_next/static/chunks/67b669c080ef588c.js\"],\"default\"]\n5:I[39863,[\"/pr-preview/pr-267/_next/static/chunks/c3bc6f5ffee68632.js\",\"/pr-preview/pr-267/_next/static/chunks/c050a2e2c81bfab4.js\"],\"\"]\nd:I[21044,[\"/pr-preview/pr-267/_next/static/chunks/7c4f85df3640cb60.js\",\"/pr-preview/pr-267/_next/static/chunks/67b669c080ef588c.js\"],\"default\"]\n:HL[\"/pr-preview/pr-267/_next/static/chunks/4c8fce464b786e05.css\",\"style\"]\n:HL[\"/pr-preview/pr-267/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/pr-preview/pr-267/_next/static/chunks/11a6a7cd862de9e1.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"MZ1yZpr1EuWGDHUHxIOaM\",\"c\":[\"\",\"articles\",\"2020-08-18-i-have-a-dream-about-secrets\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"articles\",{\"children\":[[\"slug\",\"2020-08-18-i-have-a-dream-about-secrets\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/pr-preview/pr-267/_next/static/chunks/4c8fce464b786e05.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/pr-preview/pr-267/_next/static/chunks/c3bc6f5ffee68632.js\",\"async\":true,\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-1\",{\"src\":\"/pr-preview/pr-267/_next/static/chunks/c050a2e2c81bfab4.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"h-full antialiased\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/icons/apple-touch-icon.png?v=2\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"32x32\",\"href\":\"/icons/favicon-32x32.png?v=2\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"sizes\":\"16x16\",\"href\":\"/icons/favicon-16x16.png?v=2\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/icons/site.webmanifest?v=2\"}],[\"$\",\"link\",null,{\"rel\":\"mask-icon\",\"href\":\"/icons/safari-pinned-tab.svg?v=2\",\"color\":\"#00ff00\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/icons/favicon.ico?v=2\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-TileColor\",\"content\":\"#535353\"}],[\"$\",\"meta\",null,{\"name\":\"msapplication-config\",\"content\":\"/icons/browserconfig.xml?v=2\"}],[\"$\",\"meta\",null,{\"name\":\"theme-color\",\"content\":\"#ffffff\"}],[\"$\",\"link\",null,{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"/feed.xml\"}]]}],[\"$\",\"body\",null,{\"className\":\"flex h-full bg-zinc-900 md:bg-black\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex w-full\",\"children\":[[\"$\",\"div\",null,{\"className\":\"hidden md:fixed md:inset-0 md:flex md:justify-center md:px-8 pointer-events-none z-0\",\"aria-hidden\":\"true\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"w-full ring-1 bg-zinc-900 ring-zinc-300/20\"}]}]}],[\"$\",\"div\",null,{\"className\":\"relative flex w-full flex-col text-zinc-400 z-10\",\"children\":[[\"$\",\"$L2\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-auto\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"sm:px-8 flex h-full items-center pt-16 sm:pt-32\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-base font-semibold text-zinc-500\",\"children\":\"404\"}],[\"$\",\"h1\",null,{\"className\":\"mt-4 text-4xl font-bold tracking-tight sm:text-5xl text-zinc-100\",\"children\":\"Page not found\"}],[\"$\",\"p\",null,{\"className\":\"mt-4 text-base text-zinc-400\",\"children\":\"Sorry, I couldn’t find the page you’re looking for.\"}],[\"$\",\"$L5\",null,{\"className\":\"inline-flex items-center gap-2 justify-center rounded-md py-2 px-3 text-sm outline-offset-2 transition active:transition-none font-medium active:bg-zinc-100 active:text-zinc-900/60 bg-zinc-800/50 text-zinc-300 hover:bg-zinc-800 hover:text-zinc-50 active:bg-zinc-800/50 active:text-zinc-50/70 mt-4\",\"href\":\"/\",\"children\":\"Go back home\"}]]}]}]}]}]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"mt-32 flex-none\",\"children\":[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"sm:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"border-t pt-10 pb-16 border-zinc-700/40\",\"children\":[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-between gap-6 md:flex-row\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-200\",\"children\":[[\"$\",\"$L5\",null,{\"href\":\"/\",\"className\":\"transition hover:text-teal-400\",\"children\":\"About\"}],\"$L6\",\"$L7\"]}],\"$L8\"]}]}]}]}]}]}]}]]}]]}]}]]}]]}],{\"children\":[\"$L9\",{\"children\":[\"$La\",{\"children\":[\"$Lb\",{},null,false,false]},null,false,false]},null,false,false]},null,false,false],\"$Lc\",false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:I[61879,[\"/pr-preview/pr-267/_next/static/chunks/7c4f85df3640cb60.js\",\"/pr-preview/pr-267/_next/static/chunks/67b669c080ef588c.js\"],\"OutletBoundary\"]\n10:\"$Sreact.suspense\"\n12:I[61879,[\"/pr-preview/pr-267/_next/static/chunks/7c4f85df3640cb60.js\",\"/pr-preview/pr-267/_next/static/chunks/67b669c080ef588c.js\"],\"ViewportBoundary\"]\n14:I[61879,[\"/pr-preview/pr-267/_next/static/chunks/7c4f85df3640cb60.js\",\"/pr-preview/pr-267/_next/static/chunks/67b669c080ef588c.js\"],\"MetadataBoundary\"]\n6:[\"$\",\"$L5\",null,{\"href\":\"/projects\",\"className\":\"transition hover:text-teal-400\",\"children\":\"Projects\"}]\n7:[\"$\",\"$L5\",null,{\"href\":\"/legal\",\"className\":\"transition hover:text-teal-400\",\"children\":\"Legal\"}]\n8:[\"$\",\"p\",null,{\"className\":\"text-sm text-zinc-500\",\"children\":\"© 2011 InDieTasten. All rights reserved.\"}]\n9:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\na:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\nb:[\"$\",\"$1\",\"c\",{\"children\":[\"$Le\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/pr-preview/pr-267/_next/static/chunks/11a6a7cd862de9e1.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$Lf\",null,{\"children\":[\"$\",\"$10\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@11\"}]}]]}]\nc:[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L12\",null,{\"children\":\"$L13\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$L14\",null,{\"children\":[\"$\",\"$10\",null,{\"name\":\"Next.Metadata\",\"children\":\"$L15\"}]}]}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]\n"])</script><script>self.__next_f.push([1,"13:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"11:null\n15:[[\"$\",\"title\",\"0\",{\"children\":\"I have a dream(rant) about secrets in repositories - InDieTasten\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Homepage and blog by InDieTasten.\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"I have a dream(rant) about secrets in repositories - InDieTasten\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"Homepage and blog by InDieTasten.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"5\",{\"name\":\"twitter:title\",\"content\":\"I have a dream(rant) about secrets in repositories - InDieTasten\"}],[\"$\",\"meta\",\"6\",{\"name\":\"twitter:description\",\"content\":\"Homepage and blog by InDieTasten.\"}]]\n"])</script><script>self.__next_f.push([1,":HL[\"/avatar.png\",\"image\"]\n16:T147f,"])</script><script>self.__next_f.push([1,"\u003cp\u003eTL DR: Please don't put them there\u003c/p\u003e\n\u003ch2\u003eWhat?\u003c/h2\u003e\n\u003cp\u003eI've been working in the software development business professionally for 5 years now.\nThe company I work for has yet to \"discover\" open source. We heavily use OSS, but have nothing up of our own stuff.\nThat may be the reason why nobody so far has ever questioned putting secrets into git repositories.\u003c/p\u003e\n\u003cp\u003eThat would be one of the first lessons, when pushing anything into a public repository.\nNo secrets. It's that simple.\u003c/p\u003e\n\u003ch2\u003eWhy not?\u003c/h2\u003e\n\u003cp\u003eFor public repositories, I think it should be fairly obvious, that putting secrets there is a bad idea.\u003c/p\u003e\n\u003cp\u003eBut even for private repos, there is always a chance of leaking the repo. A quick clone on some machine.\nDrive may not be encrypted and the device gets lost. Of course you forget, which repos have been cloned to that machine.\nNobody keeps track of that. I have probably 30 something repos on my dev machine. Some of which containing secrets that can potentially cause damage.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eappsettings.json =\u003e connection strings =\u003e sql db =\u003e drop\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOr even worse, silently taking dumps and blackmailing us. The problem wouldn't be as bad, when secrets would rotate often.\nBut sadly, that's another problem we haven't touched. It's been getting better lately, but there's still room for improvement.\u003c/p\u003e\n\u003cp\u003eAnother problem is versioning. It might not come off as a huge problem, but the commit history is cluttered with our devops people\ncommiting \"config\" over and over again, as they want to trigger our continuous deployment with different settings in a trial and error manner.\nIt's a cool setup. We have branches for each environment, and you just have to merge into them, and as they update, they will be deployed.\nIt's cool as long as you go \"forward\". If you want to get back to a different version, or want to try a feature branch on some environment,\nyou will be faced with reverting commits, which is kinf of stupid, because then you'd have to revert the revert, if you were to ever test that\nbranch again. Resetting the branch would be better, but often people will branch off of these CD branches, so their branch will be infected with these broken config changes that way.\u003c/p\u003e\n\u003cp\u003eAlso, any intern starting to set foot in one of the real projects requiring access to code,\nwill automatically be granted access to all of the environments secrets. Good stuff.\u003c/p\u003e\n\u003ch2\u003eA vision for improvement\u003c/h2\u003e\n\u003cp\u003eSo what's my dream solution about?\u003c/p\u003e\n\u003cp\u003eDon't put secrets into the repository. Treat every repository, as if it was public.\u003c/p\u003e\n\u003cp\u003eWhat about that cool CI/CD pipeline we have going on?\nWell, we can keep it. We just have to make some changes to it.\u003c/p\u003e\n\u003cp\u003eHave two build pipelines: Debug \u0026#x26; Release\u003c/p\u003e\n\u003cp\u003eThey are analogous to the build definitions Debug and Release.\u003c/p\u003e\n\u003cp\u003eDefine your secrets in your Release pipelines.\nHave a release pipeline for every environment.\u003c/p\u003e\n\u003cp\u003eNow you can use any build, and deploy it to any environment. No more config changes are tracked in the repo.\nHaving a hard to repro bug in production? Just deploy the Debug version there for some extra verbose error tracking for a couple minutes.\u003c/p\u003e\n\u003cp\u003eWant to test a feature branch? Select your preferred build definition. Select an environment, done.\u003c/p\u003e\n\u003cp\u003eAs a bonus, you also have increased confidence,\nthat moving a code version from one environment to another won't introduce additional changes,\nthat may have happened in the target environment branch before.\u003c/p\u003e\n\u003cp\u003eOf course you still need to communicate about who is putting what into which environment.\nUnless you can dynamically provision new environments,\nbut that's a dream for another night.\u003c/p\u003e\n\u003ch3\u003eBut what if the config schema changes?\u003c/h3\u003e\n\u003cp\u003eThat would break the pipelines, and that's good?\u003c/p\u003e\n\u003cp\u003eIt's a great way to interpret semver for code, that nobody depends on.\nIf you develop a product with no exposed APIs,\nit's a bit difficult to define what change would be breaking and therefor a major version increase.\nBut the configuration schema is kind of like an interface, that the application needs to support.\u003c/p\u003e\n\u003cp\u003eWhenever the config schema changes, or existing configs in your pipelines will break,\nthat's a major code version increase for your repository.\u003c/p\u003e\n\u003cp\u003eNow your repository is managing code only. Your commits can now focus on development.\nNo more \"config\". You don't have builds that only work for one environment.\nYou don't need to rebuild to move a code version from one environment to another.\nYou just deploy the same code with different config to the next environment.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eCode =\u003e Build\n\nBuild + Config =\u003e Release\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd the intern can finally work on all them cool projects without seeing prod credentials.\u003c/p\u003e\n\u003cp\u003eA great time to be alive.\u003c/p\u003e\n\u003ch2\u003eWho is responsible for this mess?\u003c/h2\u003e\n\u003cp\u003eMicrosoft.\u003c/p\u003e\n\u003cp\u003eAll the samples and project templates are generating configuration files ready for committing them.\nThe default VS .gitignore won't ignore appsettings.json and similar files.\u003c/p\u003e\n\u003ch1\u003eDiscussion\u003c/h1\u003e\n\u003cp\u003eAre you already living the dream?\nAre there problems I haven't thought about?\nShoot me an issue on \u003ca href=\"https://github.com/InDieTasten/indietasten.github.io/issues\"\u003eGitHub\u003c/a\u003e.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"e:[\"$\",\"main\",null,{\"children\":[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"sm:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"ref\":\"$undefined\",\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"article\",null,{\"className\":\"mb-32\",\"children\":[[[\"$\",\"h1\",null,{\"className\":\"text-5xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left\",\"children\":\"I have a dream(rant) about secrets in repositories\"}],[\"$\",\"div\",null,{\"className\":\"mb-4 flex flex-wrap gap-2\",\"children\":[[\"$\",\"span\",\"git\",{\"className\":\"bg-gray-300 text-gray-700 px-2 py-1 rounded text-xs font-medium\",\"children\":[\"#\",\"git\"]}],[\"$\",\"span\",\"secrets\",{\"className\":\"bg-gray-300 text-gray-700 px-2 py-1 rounded text-xs font-medium\",\"children\":[\"#\",\"secrets\"]}],[\"$\",\"span\",\"deployment\",{\"className\":\"bg-gray-300 text-gray-700 px-2 py-1 rounded text-xs font-medium\",\"children\":[\"#\",\"deployment\"]}]]}],[\"$\",\"div\",null,{\"className\":\"hidden md:block md:mb-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center\",\"children\":[[\"$\",\"img\",null,{\"src\":\"/avatar.png\",\"className\":\"w-12 h-12 rounded-full mr-4\",\"alt\":\"InDieTasten\"}],[\"$\",\"div\",null,{\"className\":\"text-xl font-bold\",\"children\":\"InDieTasten\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"max-w-2xl mx-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"block md:hidden mb-6\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex items-center\",\"children\":[[\"$\",\"img\",null,{\"src\":\"/avatar.png\",\"className\":\"w-12 h-12 rounded-full mr-4\",\"alt\":\"InDieTasten\"}],[\"$\",\"div\",null,{\"className\":\"text-xl font-bold\",\"children\":\"InDieTasten\"}]]}]}],[\"$\",\"div\",null,{\"className\":\"mb-6 text-lg\",\"children\":[\"$\",\"time\",null,{\"dateTime\":\"2020-08-18T00:00:00.000Z\",\"children\":\"August\\t18, 2020\"}]}]]}]],[\"$\",\"div\",null,{\"className\":\"max-w-2xl mx-auto\",\"children\":[\"$\",\"div\",null,{\"className\":\"$undefined\",\"dangerouslySetInnerHTML\":{\"__html\":\"$16\"}}]}]]}]}]}]}]}]}]\n"])</script></body></html>